/**
 * Билгийн тооллын одон орны тогтмолуудын тайлбар
 *
 * Энд буй утгууд нь Төвд–Монголын Билгийн тооллын уламжлалт алгоритмуудыг
 * (65-н хуваарьт цикл, сар/нарны дундаж хөдөлгөөн, илүү сарын дүрэм)
 * програмчлалд нийцүүлэн ашиглахад зориулагдсан калибрацийн тогтмолууд юм.
 * Тогтмолууд нь түүхэн хүснэгт болон хэрэглээний үр дүнтэй тааруулах зорилготой.
 */

// Сар тооцооллын үндсэн офсет. Mstar(Y, M) = 12*(Y - EPOCH) + M - MZERO томьёонд хэрэглэнэ.
// Энэ офсет нь лавлах жилтэй (EPOCH) уялдуулан сарын тооллыг 0 цэгт тааруулдаг.
export const MZERO = 3;

// Лавлах жил (эпох). Билгийн тооллын алгоритмуудыг энэ жилд тааруулж калибрацилсан.
// Жилийг энэ лавлах цэгээс тооцож, 60 жилийн цикл/илүү сарын дүрмийг зөв мөрдүүлнэ.
export const EPOCH = 1747;

// Жинхэнэ сар руу шилжих босго (IXX).
// trueMonth тооцоход ix < IXX үед доош (floor), түүнээс их бол дээш (ceil) авна.
// Ингэснээр сар шилжилтийн мөчийг уламжлалт хүснэгттэй тааруулна.
export const IXX = 46;

// Жинхэнэ сарын индекст ашиглах фазын офсет (β*).
// 67*Mstar + BETASTAR илэрхийллээр 65-н циклд үе шатыг зөв байрлуулна.
export const BETASTAR = 10;

// Илүү сар тодорхойлох 65-н циклд хэрэглэгдэх офсет (β).
// leapMonth: mod(24*(Y - EPOCH) + 2*M - BETA, 65) <= 1 дүрмээр илүү сар тогтооно.
export const BETA = 172;

/**
 * Дундаж хөдөлгөөний тогтмолууд (CNST)
 *
 * - m0, m1, m2: Сарны дундаж огнооны (mean lunar date) тогтмол ба өдөр тутмын өсөлтүүд
 * - s0, s1, s2: Нарны дундаж хөдөлгөөний параметрүүд
 * - a0, a1, a2: Сарны аномалийн (anomaly) параметрүүд
 *
 * Рационал бутархай хэлбэртэй эдгээр коэффициентууд нь уламжлалт хүснэгт,
 * томьёонуудтай нийцүүлэн сонгогдсон бөгөөд trueDate/trueMonth тооцоонд оролцоно.
 */
export const CNST = {
  // Сарын дундаж огнооны эхний тогтмол
  m0: 2359237 + 2603 / 2828,
  // Сарын дундаж огнооны өдөр тутмын өсөлт (нэгж: өдөр/сарын индекс)
  m1: 167025 / 5656,
  // Сарын дундаж огноонд өдрийн хувь нэмэр
  m2: 11135 / 11312,
  // Нарны дундаж уртжилтын эхний тогтмол
  s0: 397 / 402,
  // Нарны дундаж хөдөлгөөний өсөлт
  s1: 65 / 804,
  // Нарны өдөр тутмын нарийн өсөлт
  s2: 13 / 4824,
  // Сарны аномалийн эхний тогтмол
  a0: 1523 / 1764,
  // Сарны аномалийн өсөлт
  a1: 253 / 3528,
  // Сарны аномалийн өдөр тутмын нарийн өсөлт
  a2: 1 / 28,
};

// Шинэ сарын үндэс хайлтын нарийвчлал (фазын тэнцвэржилтийн тооцоонд ашиглана).
export const MOON_PHASE_PRECISION = { EPSILON: 0.0001, MIN_DELTA: 0.001 };

// Лавлах Julian Day (J2000.0 = 2451545). Тооцооллыг тогтвортой болгох үүднээс хэрэглэнэ.
export const REFERENCE_EPOCH = { JD: 2451545 };
